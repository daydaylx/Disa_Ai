/**
 * Mobile Scaling and Viewport Fixes
 * Addresses mobile scaling issues and ensures proper viewport behavior
 */

/* Reset and prevent zoom/scaling issues */
*,
*::before,
*::after {
  -webkit-text-size-adjust: 100%;
  -webkit-tap-highlight-color: transparent;
  box-sizing: border-box;
}

/* Viewport height fixes for mobile browsers */
:root {
  /* Calculate real viewport height and store in CSS custom property */
  --vh: 1vh;
}

/* Dynamic viewport height calculation */
@supports (height: 100dvh) {
  :root {
    --vh: 1dvh;
  }
}

/* Root element mobile optimizations */
html {
  height: 100%;
  /* Prevent horizontal scroll */
  overflow-x: hidden;
  /* Smooth scrolling */
  scroll-behavior: smooth;
  /* Prevent zoom on input focus */
  -webkit-text-size-adjust: 100%;
}

body {
  height: 100%;
  /* Prevent horizontal scroll */
  overflow-x: hidden;
  /* Fix for mobile Safari */
  position: relative;
  /* Prevent pull-to-refresh */
  overscroll-behavior: none;
  /* Disable text selection on touch */
  -webkit-user-select: none;
  -moz-user-select: none;
  user-select: none;
  /* Re-enable text selection for content */
}

/* Allow text selection in content areas */
[contenteditable],
input,
textarea,
.selectable,
p,
span,
h1,
h2,
h3,
h4,
h5,
h6,
.message-content {
  -webkit-user-select: text;
  -moz-user-select: text;
  user-select: text;
}

/* App root container */
#app {
  width: 100%;
  height: 100%;
  min-height: calc(var(--vh, 1vh) * 100);
  position: relative;
  overflow-x: hidden;
}

/* Touch optimizations */
button,
[role="button"],
.tappable {
  /* Improve touch response */
  touch-action: manipulation;
  /* Prevent double-tap zoom */
  -webkit-user-select: none;
  -moz-user-select: none;
  user-select: none;
}

/* Input field mobile optimizations */
input,
textarea,
select {
  /* Prevent zoom on iOS */
  font-size: var(--font-size-input);
  /* Smooth touch scrolling */
  -webkit-overflow-scrolling: touch;
  /* Improve touch response */
  touch-action: manipulation;
}

/* Fix for mobile Safari input zoom - Applied globally since we're mobile-only */
input[type="text"],
input[type="email"],
input[type="password"],
input[type="search"],
textarea {
  font-size: var(--font-size-input) !important;
  transform: scale(1);
}

/* Scrollable areas */
.scrollable {
  /* Smooth scrolling on mobile */
  -webkit-overflow-scrolling: touch;
  /* Prevent scroll bounce */
  overscroll-behavior: contain;
}

/* Safe area handling for mobile devices */
.safe-area-top {
  padding-top: env(safe-area-inset-top);
}

.safe-area-bottom {
  padding-bottom: env(safe-area-inset-bottom);
}

.safe-area-left {
  padding-left: env(safe-area-inset-left);
}

.safe-area-right {
  padding-right: env(safe-area-inset-right);
}

/* Full viewport height utilities with modern dvh support */
.min-h-screen-mobile {
  min-height: 100dvh; /* Modern dynamic viewport height */
  min-height: calc(var(--vh, 1vh) * 100); /* Fallback for older browsers */
}

.h-screen-mobile {
  height: 100dvh; /* Modern dynamic viewport height */
  height: calc(var(--vh, 1vh) * 100); /* Fallback for older browsers */
}

/* Fix for iOS Safari viewport issues */
@supports (-webkit-touch-callout: none) {
  .h-screen-mobile,
  .min-h-screen-mobile {
    min-height: -webkit-fill-available;
  }
}

/* Modern viewport units utility classes */
.min-h-dvh {
  min-height: 100dvh;
}

.h-dvh {
  height: 100dvh;
}

/* Prevent horizontal overflow */
.no-scroll-x {
  overflow-x: hidden;
  max-width: 100vw;
}

/* Performance optimizations for mobile */
.gpu-accelerated {
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
  will-change: transform;
}

/* Fix for mobile keyboard overlay */
.keyboard-adjust {
  height: calc(var(--vh, 1vh) * 100);
  transition: height 0.3s ease;
}

/* Mobile-specific animations should be disabled for performance */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* Mobile landscape orientation fix */
@media screen and (orientation: landscape) and (max-height: 500px) {
  .mobile-landscape-fix {
    height: 100vh;
    min-height: 100vh;
  }
}
