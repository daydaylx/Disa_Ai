/**
 * Universal UI State Animations
 *
 * Neomorphic micro-interactions and state transitions for the Universal State System.
 * Provides smooth, accessible animations that enhance user feedback while respecting motion preferences.
 * Optimized for performance with GPU acceleration and reduced motion support.
 */

/* ============================================================================
   PERFORMANCE OPTIMIZATIONS
   ============================================================================ */

:root {
  /* GPU-accelerated transforms */
  --transform-gpu: translate3d(0, 0, 0);
  --will-change-transform: transform;
  --will-change-opacity: opacity;
  --will-change-auto: auto;

  /* Performance-optimized durations based on device */
  --duration-performance-optimized: clamp(120ms, 0.5vw, 300ms);
  --duration-reduced-motion: 120ms;

  /* Hardware acceleration helpers */
  --gpu-layer: translateZ(0);
  --gpu-backface: hidden;
}

/* Performance optimization classes */
.gpu-accelerated {
  transform: var(--transform-gpu);
  will-change: var(--will-change-transform);
  backface-visibility: var(--gpu-backface);
}

.will-change-transform {
  will-change: var(--will-change-transform);
}

.will-change-opacity {
  will-change: var(--will-change-opacity);
}

.will-change-auto {
  will-change: var(--will-change-auto);
}

/* ============================================================================
   KEYFRAME ANIMATIONS
   ============================================================================ */

@keyframes pulse {
  0%,
  100% {
    opacity: 1;
  }
  50% {
    opacity: var(--ui-loading-opacity);
  }
}

@keyframes shimmer {
  0% {
    transform: translateX(-100%);
  }
  100% {
    transform: translateX(100%);
  }
}

@keyframes bounce-in {
  0% {
    opacity: 0;
    transform: scale(0.3);
  }
  50% {
    opacity: 1;
    transform: scale(1.05);
  }
  70% {
    transform: scale(0.9);
  }
  100% {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes gentle-glow {
  0%,
  100% {
    box-shadow: var(--shadow-neumorphic-md);
  }
  50% {
    box-shadow: var(--shadow-neumorphic-lg);
  }
}

@keyframes focus-ring-appear {
  0% {
    opacity: 0;
    transform: scale(0.95);
  }
  100% {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes subtle-lift {
  0% {
    transform: translateY(0);
  }
  100% {
    transform: var(--ui-hover-lift);
  }
}

@keyframes dramatic-lift {
  0% {
    transform: translateY(0) scale(1);
    box-shadow: var(--shadow-neumorphic-md);
  }
  100% {
    transform: translateY(-8px) scale(1.05);
    box-shadow: var(--shadow-neumorphic-dramatic);
  }
}

@keyframes neo-press {
  0% {
    transform: scale(1);
    box-shadow: var(--shadow-neumorphic-md);
  }
  100% {
    transform: scale(0.95);
    box-shadow: var(--shadow-inset-medium);
  }
}

@keyframes dramatic-glow {
  0%,
  100% {
    box-shadow: var(--shadow-neumorphic-lg);
  }
  50% {
    box-shadow:
      var(--shadow-neumorphic-dramatic),
      0 0 40px rgba(75, 99, 255, 0.3);
  }
}

@keyframes neo-float {
  0%,
  100% {
    transform: translateY(0);
    box-shadow: var(--shadow-neumorphic-lg);
  }
  50% {
    transform: translateY(-4px);
    box-shadow: var(--shadow-neumorphic-xl);
  }
}

/* ============================================================================
   UNIVERSAL STATE CLASSES
   ============================================================================ */

/**
 * Base animated class for all UI state components
 */
.ui-state-animated {
  transition: var(--ui-state-transition-all);
  will-change: transform, box-shadow, background-color, border-color;
  /* Performance optimizations */
  transform: var(--transform-gpu);
  backface-visibility: var(--gpu-backface);
}

/* Performance-aware animation class */
@media (prefers-reduced-motion: no-preference) {
  .ui-state-animated {
    transition-duration: var(--duration-performance-optimized);
  }
}

@media (prefers-reduced-motion: reduce) {
  .ui-state-animated {
    transition-duration: var(--duration-reduced-motion);
    transform: none !important;
  }
}

/**
 * Loading state
 */
.ui-loading {
  opacity: var(--ui-loading-opacity);
  animation: var(--ui-loading-pulse);
  cursor: wait;
  pointer-events: none;
}

.ui-loading::before {
  content: "";
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
  animation: var(--ui-loading-shimmer);
}

/**
 * Disabled state
 */
.ui-disabled {
  opacity: 0.6;
  cursor: not-allowed;
  pointer-events: none;
  filter: grayscale(0.3);
  transition: var(--ui-state-transition-colors);
}

/**
 * Hover state
 */
.ui-hover:not(.ui-disabled):not(.ui-loading) {
  transform: var(--ui-hover-scale);
  box-shadow: var(--shadow-neumorphic-lg);
  transition: var(--ui-state-transition-shadow), var(--ui-state-transition-transform);
}

/* Enhanced hover for interactive elements */
.ui-hover.ui-interactive:not(.ui-disabled):not(.ui-loading) {
  transform: var(--ui-hover-lift) var(--ui-hover-scale);
  box-shadow: var(--shadow-neumorphic-lg), var(--ui-hover-glow-subtle);
}

/**
 * Focus state
 */
.ui-focus:not(.ui-disabled):not(.ui-loading) {
  outline: none;
  transform: var(--ui-focus-scale);
  box-shadow: var(--ui-focus-glow), var(--shadow-neumorphic-md);
  transition: var(--ui-focus-ring-transition), var(--ui-state-transition-shadow);
  animation: focus-ring-appear 0.2s var(--neo-easing-gentle);
}

/**
 * Active/pressed state
 */
.ui-active:not(.ui-disabled):not(.ui-loading) {
  transform: var(--ui-active-press);
  box-shadow: var(--shadow-inset-subtle);
  transition: var(--ui-active-transition), var(--ui-state-transition-shadow);
}

/**
 * Selected state
 */
.ui-selected {
  background-color: var(--color-brand-subtle);
  border-color: var(--color-brand-primary);
  box-shadow: var(--shadow-neumorphic-md), var(--ui-focus-glow);
  transition: var(--ui-state-transition-colors), var(--ui-state-transition-shadow);
}

/**
 * Error state
 */
.ui-error {
  border-color: var(--color-status-danger-border);
  background-color: var(--color-status-danger-bg);
  color: var(--color-status-danger-fg);
  box-shadow: var(--shadow-neumorphic-md), var(--ui-error-glow);
  transition: var(--ui-state-transition-colors), var(--ui-state-transition-shadow);
  animation: var(--ui-state-notification-bounce);
}

/**
 * Success state
 */
.ui-success {
  border-color: var(--color-status-success-border);
  background-color: var(--color-status-success-bg);
  color: var(--color-status-success-fg);
  box-shadow: var(--shadow-neumorphic-md), var(--ui-success-glow);
  transition: var(--ui-state-transition-colors), var(--ui-state-transition-shadow);
  animation: var(--ui-state-notification-bounce);
}

/* ============================================================================
   VARIANT-SPECIFIC ANIMATIONS
   ============================================================================ */

/**
 * Neomorphic variant enhancements
 */
.ui-variant-neumorphic.ui-hover:not(.ui-disabled):not(.ui-loading) {
  box-shadow: var(--shadow-neumorphic-xl);
  animation: gentle-glow 2s ease-in-out infinite;
}

.ui-variant-neumorphic.ui-active:not(.ui-disabled):not(.ui-loading) {
  box-shadow: var(--shadow-inset-medium);
}

.ui-variant-neumorphic.ui-focus:not(.ui-disabled):not(.ui-loading) {
  box-shadow: var(--ui-focus-glow), var(--shadow-neumorphic-lg);
}

/**
 * Ghost variant enhancements
 */
.ui-variant-ghost.ui-hover:not(.ui-disabled):not(.ui-loading) {
  background-color: var(--surface-neumorphic-floating);
  transform: var(--ui-hover-scale);
}

.ui-variant-ghost.ui-active:not(.ui-disabled):not(.ui-loading) {
  background-color: var(--surface-neumorphic-pressed);
  transform: scale(0.95);
}

/**
 * Size-specific adjustments
 */
.ui-size-sm.ui-hover:not(.ui-disabled):not(.ui-loading) {
  transform: var(--ui-hover-scale);
  /* Smaller elements get more subtle animations */
}

.ui-size-lg.ui-hover:not(.ui-disabled):not(.ui-loading),
.ui-size-xl.ui-hover:not(.ui-disabled):not(.ui-loading) {
  transform: var(--ui-hover-lift) scale(1.005);
  /* Larger elements get more lift, less scale */
}

/* ============================================================================
   ACCESSIBILITY & MOTION PREFERENCES
   ============================================================================ */

/**
 * Respect reduced motion preference
 */
@media (prefers-reduced-motion: reduce) {
  .ui-state-animated,
  .ui-loading,
  .ui-hover,
  .ui-focus,
  .ui-active,
  .ui-selected,
  .ui-error,
  .ui-success {
    animation: none !important;
    transition: none !important;
  }

  /* Only allow essential state feedback */
  .ui-focus:not(.ui-disabled):not(.ui-loading) {
    outline: 2px solid var(--color-border-focus);
    outline-offset: 2px;
  }
}

/**
 * High contrast mode support
 */
@media (prefers-contrast: high) {
  .ui-focus:not(.ui-disabled):not(.ui-loading) {
    outline: 3px solid;
    outline-offset: 2px;
  }

  .ui-hover:not(.ui-disabled):not(.ui-loading) {
    outline: 1px solid;
  }
}

/* ============================================================================
   COMPOUND STATE COMBINATIONS
   ============================================================================ */

/**
 * Focus + Hover state
 */
.ui-focus.ui-hover:not(.ui-disabled):not(.ui-loading) {
  transform: var(--ui-focus-scale) var(--ui-hover-lift);
  box-shadow: var(--ui-focus-glow), var(--shadow-neumorphic-xl);
}

/**
 * Active + Focus state
 */
.ui-active.ui-focus:not(.ui-disabled):not(.ui-loading) {
  transform: var(--ui-active-press);
  box-shadow: var(--ui-focus-glow), var(--shadow-inset-subtle);
}

/**
 * Selected + Hover state
 */
.ui-selected.ui-hover:not(.ui-disabled):not(.ui-loading) {
  background-color: var(--color-brand-primary);
  color: var(--color-brand-on-primary);
  transform: var(--ui-hover-scale);
}

/**
 * Loading state overrides all other states
 */
.ui-loading {
  transform: none !important;
  box-shadow: var(--shadow-neumorphic-md) !important;
}

/* ============================================================================
   MICRO-INTERACTIONS
   ============================================================================ */

/**
 * Button-specific micro-interactions
 */
button.ui-state-animated,
[role="button"].ui-state-animated {
  position: relative;
  overflow: hidden;
}

button.ui-state-animated::after,
[role="button"].ui-state-animated::after {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  background: radial-gradient(circle, rgba(255, 255, 255, 0.3) 0%, transparent 70%);
  transition:
    width 0.3s var(--neo-easing-gentle),
    height 0.3s var(--neo-easing-gentle);
  transform: translate(-50%, -50%);
  pointer-events: none;
}

button.ui-active::after,
[role="button"].ui-active::after {
  width: 100px;
  height: 100px;
}

/**
 * Card-specific micro-interactions
 */
.ui-card-interactive.ui-hover:not(.ui-disabled):not(.ui-loading) {
  animation: subtle-lift 0.2s var(--neo-easing-lift) forwards;
}

/**
 * Input-specific micro-interactions
 */
input.ui-state-animated,
textarea.ui-state-animated,
select.ui-state-animated {
  transition: var(--ui-state-transition-colors), var(--ui-state-transition-shadow);
}

input.ui-focus,
textarea.ui-focus,
select.ui-focus {
  transform: none; /* Inputs don't scale on focus */
  box-shadow: var(--ui-focus-glow);
}

/* ============================================================================
   DRAMATIC NEOMORPHIC ANIMATIONS
   ============================================================================ */

/**
 * Dramatic neomorphic interaction classes
 */
.neo-dramatic-lift:hover:not(.ui-disabled):not(.ui-loading) {
  animation: dramatic-lift 0.3s var(--neo-easing-lift) forwards;
}

.neo-press:active:not(.ui-disabled):not(.ui-loading) {
  animation: neo-press 0.15s var(--neo-easing-gentle) forwards;
}

.neo-dramatic-glow:hover:not(.ui-disabled):not(.ui-loading) {
  animation: dramatic-glow 2s ease-in-out infinite;
}

.neo-float {
  animation: neo-float 3s ease-in-out infinite;
}

/**
 * Enhanced button micro-interactions
 */
.neo-button-dramatic:hover:not(.ui-disabled):not(.ui-loading) {
  animation: dramatic-lift 0.3s var(--neo-easing-lift) forwards;
}

.neo-button-dramatic:active:not(.ui-disabled):not(.ui-loading) {
  animation: neo-press 0.15s var(--neo-easing-gentle) forwards;
}

/**
 * Enhanced card interactions
 */
.neo-card-floating:hover:not(.ui-disabled):not(.ui-loading) {
  animation: dramatic-lift 0.4s var(--neo-easing-lift) forwards;
}

.neo-card-glow:hover:not(.ui-disabled):not(.ui-loading) {
  animation: dramatic-glow 2.5s ease-in-out infinite;
}

/**
 * Performance-optimized dramatic animations
 */
@media (prefers-reduced-motion: no-preference) {
  .neo-enhanced-performance {
    will-change: transform, box-shadow;
    transform: translateZ(0);
    backface-visibility: hidden;
  }
}

@media (prefers-reduced-motion: reduce) {
  .neo-dramatic-lift:hover,
  .neo-press:active,
  .neo-dramatic-glow:hover,
  .neo-float,
  .neo-button-dramatic:hover,
  .neo-button-dramatic:active,
  .neo-card-floating:hover,
  .neo-card-glow:hover {
    animation: none !important;
  }
}

/* ============================================================================
   PERFORMANCE OPTIMIZATIONS
   ============================================================================ */

/**
 * GPU-accelerated neomorphic elements
 */
.neo-gpu-optimized {
  transform: translateZ(0);
  will-change: transform, box-shadow, opacity;
  backface-visibility: hidden;
  perspective: 1000px;
}

/**
 * Critical rendering path optimization
 */
.neo-critical-rendering {
  contain: layout style paint;
  content-visibility: auto;
}

/**
 * Lazy loading optimization for non-critical neomorphic elements
 */
.neo-lazy-load {
  contain: layout;
  content-visibility: auto;
  contain-intrinsic-size: 1px 200px;
}

/**
 * Shadow optimization classes
 */
.neo-shadow-optimized {
  /* Use composite layers for shadows */
  isolation: isolate;
  /* Reduce repaints */
  transform: translateZ(0);
}

/**
 * Mobile performance optimizations
 */
@media (hover: none) and (pointer: coarse) {
  .neo-mobile-optimized {
    /* Reduce animation complexity on mobile */
    animation-duration: 0.2s !important;
    transform: none;
  }

  .neo-mobile-optimized:hover {
    /* Disable hover animations on touch devices */
    animation: none !important;
  }

  .neo-mobile-optimized:active {
    /* Use simple scale for touch feedback */
    transform: scale(0.95);
    transition: transform 0.1s ease;
  }
}

/**
 * High refresh rate display optimization
 */
@media (min-resolution: 120dpi) {
  .neo-high-refresh {
    animation-duration: calc(var(--animation-duration) * 0.8);
    transition-duration: calc(var(--transition-duration) * 0.8);
  }
}

/**
 * Memory-conscious animations for low-end devices
 */
@media (max-width: 768px) and (max-height: 1024px) {
  .neo-memory-conscious {
    /* Reduce shadow complexity */
    box-shadow: var(--shadow-neumorphic-sm) !important;
    /* Simplify transforms */
    transform: translateY(-2px) !important;
  }

  .neo-memory-conscious:hover {
    box-shadow: var(--shadow-neumorphic-md) !important;
  }
}

/**
 * Battery-saving mode
 */
@media (prefers-reduced-motion: reduce) {
  .neo-battery-saver {
    animation: none !important;
    transition: none !important;
    will-change: auto !important;
    transform: none !important;
  }
}

/* ============================================================================
   ADVANCED DRAMATIC NEOMORPHIC PERFORMANCE
   ============================================================================ */

/**
 * Dramatic shadow GPU optimization
 */
.neo-dramatic-gpu {
  /* Force GPU layers for complex shadows */
  transform: translateZ(0);
  will-change: transform, box-shadow;
  isolation: isolate;
  contain: layout style paint;
  /* Prevent shadow bleeding */
  overflow: hidden;
  /* Hardware acceleration hints */
  backface-visibility: hidden;
  perspective: 1000px;
}

/**
 * Extreme shadow performance class
 */
.neo-extreme-performance {
  /* Pre-optimize for extreme shadows (100px+) */
  contain: layout style paint size;
  content-visibility: auto;
  transform: translate3d(0, 0, 0);
  /* Reduce layout thrashing */
  position: relative;
  z-index: 1;
}

/**
 * Dramatic animation performance optimization
 */
.neo-dramatic-optimized {
  /* Composite layer for complex animations */
  transform: translateZ(0);
  will-change: transform, box-shadow, opacity;
  /* Paint containment for better perf */
  contain: layout style paint;
  /* Reduce repaints during dramatic hover effects */
  isolation: isolate;
}

/**
 * Dramatic shadow containment for large elements
 */
.neo-large-shadow-container {
  /* Contains shadow rendering within bounds */
  contain: layout style paint;
  /* Prevent expensive reflows from dramatic shadows */
  overflow: visible;
  /* GPU layer for shadow rendering */
  transform: translateZ(0);
  /* Optimize composite layers */
  isolation: isolate;
}

/**
 * Performance-aware dramatic scaling
 */
@media (prefers-reduced-motion: no-preference) {
  .neo-dramatic-scale:hover {
    transform: translateZ(0) scale(1.05) translateY(-8px);
    transition:
      transform 0.3s var(--neo-easing-lift),
      box-shadow 0.3s var(--neo-easing-lift);
    will-change: transform, box-shadow;
  }
}

@media (prefers-reduced-motion: reduce) {
  .neo-dramatic-scale:hover {
    /* Fallback to border highlight for reduced motion */
    box-shadow: 0 0 0 2px var(--color-brand-primary);
    border: none;
    transition: box-shadow 0.2s ease;
  }
}

/* ============================================================================
   ACCESSIBILITY ENHANCEMENTS
   ============================================================================ */

/**
 * Screen reader optimization for neomorphic elements
 */
.neo-sr-optimized {
  /* Ensure screen readers can identify interactive elements */
  position: relative;
}

.neo-sr-optimized::before {
  /* Hidden content for screen readers */
  content: attr(aria-label) " - Interactive neomorphic element";
  position: absolute;
  left: -10000px;
  width: 1px;
  height: 1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
}

/**
 * High contrast mode dramatic neomorphic fallback
 */
@media (prefers-contrast: high) {
  .neo-dramatic-fallback {
    /* Replace dramatic shadows with high contrast borders */
    border: none;
    box-shadow: 0 0 0 3px var(--color-text-primary) !important;
    background: var(--surface-neumorphic-base);
  }

  .neo-dramatic-fallback:hover {
    box-shadow: 0 0 0 3px var(--color-brand-primary) !important;
    background: var(--color-brand-subtle);
  }

  .neo-dramatic-fallback:focus {
    outline: 3px solid var(--color-brand-primary);
    outline-offset: 2px;
  }
}

/**
 * Enhanced focus management for dramatic effects
 */
.neo-dramatic-focus:focus {
  /* Ensure focus is always visible even with dramatic shadows */
  outline: 3px solid var(--color-brand-primary);
  outline-offset: 4px;
  /* Increase z-index to ensure visibility */
  z-index: var(--z-popover);
  position: relative;
}

/**
 * Prefers-contrast support for neomorphic elements
 */
@media (prefers-contrast: more) {
  .neo-contrast-enhanced {
    /* Increase contrast for better visibility */
    filter: contrast(1.2);
    box-shadow:
      var(--shadow-neumorphic-dramatic),
      0 0 0 1px var(--color-text-primary);
  }
}

/* ============================================================================
   RESPONSIVE PERFORMANCE OPTIMIZATIONS
   ============================================================================ */

/**
 * Desktop optimizations for dramatic effects
 */
@media (min-width: 1024px) and (prefers-reduced-motion: no-preference) {
  .neo-desktop-enhanced {
    /* Enable full dramatic effects on desktop */
    animation-duration: 0.3s;
    transition-duration: 0.3s;
    will-change: transform, box-shadow, filter;
  }

  .neo-desktop-enhanced:hover {
    /* Full dramatic transformation on desktop */
    transform: translateY(-8px) scale(1.05) rotateX(5deg);
    box-shadow: var(--shadow-neumorphic-extreme);
    filter: brightness(1.05);
  }
}

/**
 * Tablet optimizations
 */
@media (min-width: 768px) and (max-width: 1023px) {
  .neo-tablet-optimized {
    /* Moderate dramatic effects on tablet */
    animation-duration: 0.25s;
    transition-duration: 0.25s;
  }

  .neo-tablet-optimized:hover {
    transform: translateY(-4px) scale(1.02);
    box-shadow: var(--shadow-neumorphic-dramatic);
  }
}

/**
 * Mobile-first dramatic optimizations
 */
@media (max-width: 767px) {
  .neo-mobile-dramatic {
    /* Lighter dramatic effects on mobile */
    animation-duration: 0.2s;
    transition-duration: 0.2s;
  }

  .neo-mobile-dramatic:active {
    /* Touch feedback with reduced complexity */
    transform: scale(0.95);
    box-shadow: var(--shadow-neumorphic-lg);
    transition: all 0.1s ease;
  }
}

/* ============================================================================
   ADVANCED MOTION PREFERENCES
   ============================================================================ */

/**
 * Granular motion control
 */
@media (prefers-reduced-motion: reduce) {
  /* Completely disable all dramatic animations */
  .neo-no-motion {
    animation: none !important;
    transition: none !important;
    transform: none !important;
  }

  /* Allow only essential state changes */
  .neo-essential-motion {
    animation: none !important;
    transition:
      background-color 0.2s ease,
      border-color 0.2s ease,
      opacity 0.2s ease;
    transform: none !important;
  }
}

/**
 * Safe motion for users who prefer reduced motion but need some feedback
 */
@media (prefers-reduced-motion: reduce) {
  .neo-safe-motion:hover {
    /* Subtle color change instead of transform */
    background-color: var(--surface-neumorphic-raised);
    border-color: var(--color-brand-primary);
    transition:
      background-color 0.3s ease,
      border-color 0.3s ease;
  }

  .neo-safe-motion:focus {
    /* Strong focus indication without animation */
    outline: 3px solid var(--color-brand-primary);
    outline-offset: 2px;
    box-shadow: 0 0 0 6px rgba(75, 99, 255, 0.2);
  }
}

/* ============================================================================
   DEVICE-SPECIFIC OPTIMIZATIONS
   ============================================================================ */

/**
 * Low-power device optimization
 */
@media (max-width: 480px) and (max-height: 800px) {
  .neo-low-power {
    /* Minimal effects for low-power devices */
    box-shadow: var(--shadow-neumorphic-sm) !important;
    transform: none !important;
    animation: none !important;
    transition: opacity 0.2s ease;
  }
}

/**
 * High-performance device enhancements
 */
@media (min-width: 1440px) and (min-height: 900px) {
  .neo-high-performance {
    /* Enhanced effects for high-performance devices */
    will-change: transform, box-shadow, filter, opacity;
    transition-timing-function: var(--neo-easing-emphasized);
  }

  .neo-high-performance:hover {
    /* Advanced 3D transformations */
    transform: translateY(-12px) scale(1.08) rotateX(8deg) rotateY(2deg);
    box-shadow:
      var(--shadow-neumorphic-extreme),
      0 0 60px rgba(75, 99, 255, 0.3);
    filter: brightness(1.1) saturate(1.1);
  }
}
