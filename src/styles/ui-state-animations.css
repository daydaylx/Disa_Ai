/**
 * Universal UI State Animations
 *
 * Neomorphic micro-interactions and state transitions for the Universal State System.
 * Provides smooth, accessible animations that enhance user feedback while respecting motion preferences.
 * Optimized for performance with GPU acceleration and reduced motion support.
 */

/* ============================================================================
   PERFORMANCE OPTIMIZATIONS
   ============================================================================ */

:root {
  /* GPU-accelerated transforms */
  --transform-gpu: translate3d(0, 0, 0);
  --will-change-transform: transform;
  --will-change-opacity: opacity;
  --will-change-auto: auto;

  /* Performance-optimized durations based on device */
  --duration-performance-optimized: clamp(120ms, 0.5vw, 300ms);
  --duration-reduced-motion: 120ms;

  /* Hardware acceleration helpers */
  --gpu-layer: translateZ(0);
  --gpu-backface: hidden;
}

/* Performance optimization classes */
.gpu-accelerated {
  transform: var(--transform-gpu);
  will-change: var(--will-change-transform);
  backface-visibility: var(--gpu-backface);
}

.will-change-transform {
  will-change: var(--will-change-transform);
}

.will-change-opacity {
  will-change: var(--will-change-opacity);
}

.will-change-auto {
  will-change: var(--will-change-auto);
}

/* ============================================================================
   KEYFRAME ANIMATIONS
   ============================================================================ */

@keyframes pulse {
  0%,
  100% {
    opacity: 1;
  }
  50% {
    opacity: var(--ui-loading-opacity);
  }
}

@keyframes shimmer {
  0% {
    transform: translateX(-100%);
  }
  100% {
    transform: translateX(100%);
  }
}

@keyframes bounce-in {
  0% {
    opacity: 0;
    transform: scale(0.3);
  }
  50% {
    opacity: 1;
    transform: scale(1.05);
  }
  70% {
    transform: scale(0.9);
  }
  100% {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes gentle-glow {
  0%,
  100% {
    box-shadow: var(--shadow-neumorphic-md);
  }
  50% {
    box-shadow: var(--shadow-neumorphic-lg);
  }
}

@keyframes focus-ring-appear {
  0% {
    opacity: 0;
    transform: scale(0.95);
  }
  100% {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes subtle-lift {
  0% {
    transform: translateY(0);
  }
  100% {
    transform: var(--ui-hover-lift);
  }
}

/* ============================================================================
   UNIVERSAL STATE CLASSES
   ============================================================================ */

/**
 * Base animated class for all UI state components
 */
.ui-state-animated {
  transition: var(--ui-state-transition-all);
  will-change: transform, box-shadow, background-color, border-color;
  /* Performance optimizations */
  transform: var(--transform-gpu);
  backface-visibility: var(--gpu-backface);
}

/* Performance-aware animation class */
@media (prefers-reduced-motion: no-preference) {
  .ui-state-animated {
    transition-duration: var(--duration-performance-optimized);
  }
}

@media (prefers-reduced-motion: reduce) {
  .ui-state-animated {
    transition-duration: var(--duration-reduced-motion);
    transform: none !important;
  }
}

/**
 * Loading state
 */
.ui-loading {
  opacity: var(--ui-loading-opacity);
  animation: var(--ui-loading-pulse);
  cursor: wait;
  pointer-events: none;
}

.ui-loading::before {
  content: "";
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
  animation: var(--ui-loading-shimmer);
}

/**
 * Disabled state
 */
.ui-disabled {
  opacity: 0.6;
  cursor: not-allowed;
  pointer-events: none;
  filter: grayscale(0.3);
  transition: var(--ui-state-transition-colors);
}

/**
 * Hover state
 */
.ui-hover:not(.ui-disabled):not(.ui-loading) {
  transform: var(--ui-hover-scale);
  box-shadow: var(--shadow-neumorphic-lg);
  transition: var(--ui-state-transition-shadow), var(--ui-state-transition-transform);
}

/* Enhanced hover for interactive elements */
.ui-hover.ui-interactive:not(.ui-disabled):not(.ui-loading) {
  transform: var(--ui-hover-lift) var(--ui-hover-scale);
  box-shadow: var(--shadow-neumorphic-lg), var(--ui-hover-glow-subtle);
}

/**
 * Focus state
 */
.ui-focus:not(.ui-disabled):not(.ui-loading) {
  outline: none;
  transform: var(--ui-focus-scale);
  box-shadow: var(--ui-focus-glow), var(--shadow-neumorphic-md);
  transition: var(--ui-focus-ring-transition), var(--ui-state-transition-shadow);
  animation: focus-ring-appear 0.2s var(--neo-easing-gentle);
}

/**
 * Active/pressed state
 */
.ui-active:not(.ui-disabled):not(.ui-loading) {
  transform: var(--ui-active-press);
  box-shadow: var(--shadow-inset-subtle);
  transition: var(--ui-active-transition), var(--ui-state-transition-shadow);
}

/**
 * Selected state
 */
.ui-selected {
  background-color: var(--color-brand-subtle);
  border-color: var(--color-brand-primary);
  box-shadow: var(--shadow-neumorphic-md), var(--ui-focus-glow);
  transition: var(--ui-state-transition-colors), var(--ui-state-transition-shadow);
}

/**
 * Error state
 */
.ui-error {
  border-color: var(--color-status-danger-border);
  background-color: var(--color-status-danger-bg);
  color: var(--color-status-danger-fg);
  box-shadow: var(--shadow-neumorphic-md), var(--ui-error-glow);
  transition: var(--ui-state-transition-colors), var(--ui-state-transition-shadow);
  animation: var(--ui-state-notification-bounce);
}

/**
 * Success state
 */
.ui-success {
  border-color: var(--color-status-success-border);
  background-color: var(--color-status-success-bg);
  color: var(--color-status-success-fg);
  box-shadow: var(--shadow-neumorphic-md), var(--ui-success-glow);
  transition: var(--ui-state-transition-colors), var(--ui-state-transition-shadow);
  animation: var(--ui-state-notification-bounce);
}

/* ============================================================================
   VARIANT-SPECIFIC ANIMATIONS
   ============================================================================ */

/**
 * Neomorphic variant enhancements
 */
.ui-variant-neumorphic.ui-hover:not(.ui-disabled):not(.ui-loading) {
  box-shadow: var(--shadow-neumorphic-xl);
  animation: gentle-glow 2s ease-in-out infinite;
}

.ui-variant-neumorphic.ui-active:not(.ui-disabled):not(.ui-loading) {
  box-shadow: var(--shadow-inset-medium);
}

.ui-variant-neumorphic.ui-focus:not(.ui-disabled):not(.ui-loading) {
  box-shadow: var(--ui-focus-glow), var(--shadow-neumorphic-lg);
}

/**
 * Ghost variant enhancements
 */
.ui-variant-ghost.ui-hover:not(.ui-disabled):not(.ui-loading) {
  background-color: var(--color-surface-subtle);
  transform: var(--ui-hover-scale);
}

.ui-variant-ghost.ui-active:not(.ui-disabled):not(.ui-loading) {
  background-color: var(--color-surface-muted);
  transform: scale(0.95);
}

/**
 * Size-specific adjustments
 */
.ui-size-sm.ui-hover:not(.ui-disabled):not(.ui-loading) {
  transform: var(--ui-hover-scale);
  /* Smaller elements get more subtle animations */
}

.ui-size-lg.ui-hover:not(.ui-disabled):not(.ui-loading),
.ui-size-xl.ui-hover:not(.ui-disabled):not(.ui-loading) {
  transform: var(--ui-hover-lift) scale(1.005);
  /* Larger elements get more lift, less scale */
}

/* ============================================================================
   ACCESSIBILITY & MOTION PREFERENCES
   ============================================================================ */

/**
 * Respect reduced motion preference
 */
@media (prefers-reduced-motion: reduce) {
  .ui-state-animated,
  .ui-loading,
  .ui-hover,
  .ui-focus,
  .ui-active,
  .ui-selected,
  .ui-error,
  .ui-success {
    animation: none !important;
    transition: none !important;
  }

  /* Only allow essential state feedback */
  .ui-focus:not(.ui-disabled):not(.ui-loading) {
    outline: 2px solid var(--color-border-focus);
    outline-offset: 2px;
  }
}

/**
 * High contrast mode support
 */
@media (prefers-contrast: high) {
  .ui-focus:not(.ui-disabled):not(.ui-loading) {
    outline: 3px solid;
    outline-offset: 2px;
  }

  .ui-hover:not(.ui-disabled):not(.ui-loading) {
    outline: 1px solid;
  }
}

/* ============================================================================
   COMPOUND STATE COMBINATIONS
   ============================================================================ */

/**
 * Focus + Hover state
 */
.ui-focus.ui-hover:not(.ui-disabled):not(.ui-loading) {
  transform: var(--ui-focus-scale) var(--ui-hover-lift);
  box-shadow: var(--ui-focus-glow), var(--shadow-neumorphic-xl);
}

/**
 * Active + Focus state
 */
.ui-active.ui-focus:not(.ui-disabled):not(.ui-loading) {
  transform: var(--ui-active-press);
  box-shadow: var(--ui-focus-glow), var(--shadow-inset-subtle);
}

/**
 * Selected + Hover state
 */
.ui-selected.ui-hover:not(.ui-disabled):not(.ui-loading) {
  background-color: var(--color-brand-primary);
  color: var(--color-brand-on-primary);
  transform: var(--ui-hover-scale);
}

/**
 * Loading state overrides all other states
 */
.ui-loading {
  transform: none !important;
  box-shadow: var(--shadow-neumorphic-md) !important;
}

/* ============================================================================
   MICRO-INTERACTIONS
   ============================================================================ */

/**
 * Button-specific micro-interactions
 */
button.ui-state-animated,
[role="button"].ui-state-animated {
  position: relative;
  overflow: hidden;
}

button.ui-state-animated::after,
[role="button"].ui-state-animated::after {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  background: radial-gradient(circle, rgba(255, 255, 255, 0.3) 0%, transparent 70%);
  transition:
    width 0.3s var(--neo-easing-gentle),
    height 0.3s var(--neo-easing-gentle);
  transform: translate(-50%, -50%);
  pointer-events: none;
}

button.ui-active::after,
[role="button"].ui-active::after {
  width: 100px;
  height: 100px;
}

/**
 * Card-specific micro-interactions
 */
.ui-card-interactive.ui-hover:not(.ui-disabled):not(.ui-loading) {
  animation: subtle-lift 0.2s var(--neo-easing-lift) forwards;
}

/**
 * Input-specific micro-interactions
 */
input.ui-state-animated,
textarea.ui-state-animated,
select.ui-state-animated {
  transition: var(--ui-state-transition-colors), var(--ui-state-transition-shadow);
}

input.ui-focus,
textarea.ui-focus,
select.ui-focus {
  transform: none; /* Inputs don't scale on focus */
  box-shadow: var(--ui-focus-glow);
}
