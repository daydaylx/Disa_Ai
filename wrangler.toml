# Cloudflare Pages Konfiguration - Konsolidierte Version
# Bootstrap-Fix & Deployment-Härtung

name = "disaai"
compatibility_date = "2025-11-16"
pages_build_output_dir = "dist"

# Rate Limiting KV Namespace - WICHTIG: IDs müssen in Cloudflare Dashboard erstellt werden
[[kv_namespaces]]
binding = "RATE_LIMIT_KV"
id = "0d65c85d47bf490f961707338ad47993"  # Production KV-Namespace ID
preview_id = "eca29f3a0056484785f3b0f6637c8f58"  # Preview KV-Namespace ID

[env.production]
# Main branch als Produktionsumgebung
pages_build_output_dir = "dist"
compatibility_date = "2025-11-16"

[env.production.vars]
NODE_ENV = "production"
VITE_OPENROUTER_BASE_URL = "https://openrouter.ai/api/v1"
VITE_BASE_URL = "/"
VITE_ENABLE_ANALYTICS = "false"
VITE_ENABLE_DEBUG = "false"
VITE_ENABLE_PWA = "true"
VITE_ENV = "production"
VITE_SENTRY_DSN = ""
SENTRY_ORG = "disa-ai"
SENTRY_PROJECT = "disa-ai-web"
# Build info wird automatisch durch scripts gesetzt
VITE_BUILD_ID = ""
VITE_BUILD_TIME = ""
VITE_BUILD_TIMESTAMP = ""
VITE_GIT_SHA = ""
VITE_GIT_BRANCH = ""
VITE_VERSION = ""

  # KRITISCH: Fehlende Secrets - müssen in Cloudflare Dashboard gesetzt werden:
  # - OPENROUTER_API_KEY (für functions/api/chat.ts)
  # - VITE_OPENROUTER_API_KEY (für Frontend)
  # - SENTRY_AUTH_TOKEN (optional, für Sentry Integration)

  [[env.production.kv_namespaces]]
  binding = "RATE_LIMIT_KV"
  id = "0d65c85d47bf490f961707338ad47993"  # Production KV-Namespace ID

[env.preview]
# Alle anderen Branches als Preview-Umgebung
pages_build_output_dir = "dist"
compatibility_date = "2025-11-16"

[env.preview.vars]
NODE_ENV = "production"
VITE_OPENROUTER_BASE_URL = "https://openrouter.ai/api/v1"
VITE_BASE_URL = "/"
VITE_ENABLE_ANALYTICS = "false"
VITE_ENABLE_DEBUG = "true"
VITE_ENABLE_PWA = "true"
VITE_ENV = "staging"
VITE_SENTRY_DSN = ""
SENTRY_ORG = "disa-ai"
SENTRY_PROJECT = "disa-ai-web"
# Build info wird automatisch durch scripts gesetzt
VITE_BUILD_ID = ""
VITE_BUILD_TIME = ""
VITE_BUILD_TIMESTAMP = ""
VITE_GIT_SHA = ""
VITE_GIT_BRANCH = ""
VITE_VERSION = ""

  [[env.preview.kv_namespaces]]
  binding = "RATE_LIMIT_KV"
  id = "eca29f3a0056484785f3b0f6637c8f58"  # Preview KV-Namespace ID

# DEPLOYMENT-INSTRUKTIONEN:
# 1. Cloudflare Pages Dashboard → Settings → Environment variables
# 2. Production secrets hinzufügen: OPENROUTER_API_KEY, VITE_OPENROUTER_API_KEY
# 3. KV-Namespaces erstellen: Workers & Pages → KV → Create namespace
# 4. KV-IDs in dieser Datei ersetzen
# 5. Cache purging und deploy hooks über Pages Dashboard verwalten

